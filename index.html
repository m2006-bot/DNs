<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Wateen OS v1.1 Gold</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Wateen OS">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    
    <link rel="apple-touch-icon" href="https://iili.io/fkhg119.jpg">
    <link rel="icon" href="https://iili.io/fkhg119.jpg">
    <link rel="manifest" href="manifest.json">

    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg: #000;
            --accent: #00f3ff;
            --pink: #ff2d55;
            --card: #121212;
            --sheet-bg: #1c1c1e;
        }

        /* Ù…Ù†Ø¹ Ø§Ù„Ù†Ø³Ø® ÙˆØ§Ù„Ø§Ø®ØªÙŠØ§Ø± Ù„Ø¶Ù…Ø§Ù† ØªØ¬Ø±Ø¨Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„Ø© */
        * { 
            box-sizing: border-box; margin: 0; padding: 0; 
            -webkit-user-select: none; user-select: none;
            -webkit-touch-callout: none; -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg); color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            height: 100vh; overflow: hidden; display: flex; flex-direction: column;
            background: radial-gradient(circle at bottom, #0a0a0a 0%, #000 100%);
        }

        .app-shell { 
            flex: 1; display: flex; flex-direction: column; 
            padding: env(safe-area-inset-top) 25px env(safe-area-inset-bottom); 
        }

        /* Header */
        .brand-header { display: flex; align-items: center; justify-content: center; gap: 12px; padding-top: 25px; }
        .user-img { width: 50px; height: 50px; border-radius: 50%; border: 2px solid var(--accent); object-fit: cover; box-shadow: 0 0 15px var(--accent); }
        .brand-header h1 { font-family: 'Tajawal'; font-size: 1.8rem; letter-spacing: 1px; }

        .slogan-text { 
            text-align: center; color: #555; font-size: 0.85rem; 
            font-family: 'Tajawal'; margin-top: 8px; margin-bottom: 35px; /* ÙØ±Ø§Øº Ù„Ø¬Ù…Ø§Ù„ÙŠØ© Ø§Ù„ØªØµÙ…ÙŠÙ… */
            font-weight: bold;
        }

        /* Smart Alert (Top) */
        .smart-alert {
            position: fixed; top: -100px; left: 50%; transform: translateX(-50%);
            width: 90%; background: rgba(30, 30, 30, 0.95); backdrop-filter: blur(25px);
            padding: 15px; border-radius: 20px; border: 1px solid #333;
            display: flex; align-items: center; gap: 12px; z-index: 10000;
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .smart-alert.active { top: 30px; }

        /* Action Sheet */
        .action-sheet-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); display: none; z-index: 10001; align-items: flex-end;
        }
        .action-sheet { width: 100%; background: var(--sheet-bg); border-radius: 25px 25px 0 0; padding: 25px; animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        
        .sheet-btn { width: 100%; padding: 18px; border-radius: 18px; border: none; font-family: 'Tajawal'; font-weight: bold; margin-bottom: 12px; font-size: 1rem; }
        .btn-danger { background: var(--pink); color: #fff; }
        .btn-cancel { background: #3a3a3c; color: #fff; }

        /* Tasks Area */
        .tasks-list { flex: 1; overflow-y: auto; }
        .input-group { display: flex; gap: 12px; background: var(--card); padding: 12px; border-radius: 20px; border: 1px solid #222; margin-bottom: 20px; }
        .ios-input { flex: 1; background: transparent; border: none; color: #fff; font-family: 'Tajawal'; outline: none; font-size: 1rem; }
        
        .task-card { background: var(--card); padding: 18px; border-radius: 22px; display: flex; align-items: center; justify-content: space-between; border: 1px solid #1a1a1a; margin-bottom: 12px; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .check-btn { width: 32px; height: 32px; border: 2px solid #333; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        .check-btn.done { background: var(--accent); border-color: var(--accent); color: #000; }

        /* Timer Area */
        .timer-container { padding: 25px 0; text-align: center; }
        .timer-text { font-size: 8rem; font-weight: 900; letter-spacing: -5px; line-height: 1; text-shadow: 0 0 20px rgba(0,243,255,0.2); }

        /* Controls */
        .controls { display: grid; grid-template-columns: 1fr 75px; gap: 15px; padding-bottom: 10px; }
        .btn { height: 75px; border-radius: 25px; border: none; font-family: 'Tajawal'; font-weight: 900; font-size: 1.3rem; cursor: pointer; transition: 0.2s; }
        .btn-main { background: #fff; color: #000; }
        .btn-main.active-mode { background: var(--pink); color: #fff; }
        .btn-reset { background: var(--card); color: #fff; border: 1px solid #222; }

        .version-tag { text-align: center; font-size: 0.65rem; color: #333; padding-bottom: 15px; font-family: 'Tajawal'; letter-spacing: 2px; }
    </style>
</head>
<body oncontextmenu="return false;">

    <div class="smart-alert" id="alertBox">
        <i id="alertIcon" class="fas fa-ghost" style="color: var(--accent); font-size: 1.4rem;"></i>
        <span id="alertMsg" style="font-family: 'Tajawal'; font-size: 0.85rem; font-weight: bold;"></span>
    </div>

    <div class="action-sheet-overlay" id="sheetOverlay">
        <div class="action-sheet">
            <h3 style="font-family:'Tajawal'; text-align:center; margin-bottom:20px; font-size: 1.1rem;">Ø¥Ø¹Ø§Ø¯Ø© ØªØµÙÙŠØ± Ù†Ø¸Ø§Ù… ÙˆØªÙŠÙ†ØŸ ğŸ˜­</h3>
            <button class="sheet-btn btn-danger" onclick="confirmReset()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø³Ø­ Ø§Ù„Ø´Ø§Ù…Ù„</button>
            <button class="sheet-btn btn-cancel" onclick="closeSheet()">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±Ø¬ÙˆØ¹</button>
        </div>
    </div>

    <div class="app-shell">
        <header class="brand-header">
            <img src="https://iili.io/fkhg119.jpg" alt="Wateen" class="user-img">
            <h1>WATEEN <span style="color:var(--accent)">OS</span></h1>
        </header>
        <div class="slogan-text">Ù†Ø¸Ø§Ù… Ø§Ù„Ù†ØµØ¨ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ù…Ø·ÙˆØ± ğŸŒš</div>

        <div class="tasks-list">
            <div class="input-group">
                <input type="text" id="tInput" class="ios-input" placeholder="Ø§ÙƒØªØ¨ÙŠ Ù‡Ø¯Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯...">
                <button onclick="addTask()" style="background:transparent; border:none; color:var(--accent); font-size: 1.6rem;"><i class="fas fa-plus-circle"></i></button>
            </div>
            <div id="tList"></div>
        </div>

        <div class="timer-container">
            <div class="timer-text" id="tDisplay">40:00</div>
        </div>

        <div class="controls">
            <button class="btn btn-main" id="startBtn" onclick="handleTimer()">Ø¨Ø¯Ø¡ Ø§Ù„Ù†ØµØ¨</button>
            <button class="btn btn-reset" onclick="openSheet()"><i class="fas fa-power-off"></i></button>
        </div>

        <div class="version-tag">VERSION 1.1 GOLD â€¢ BY WATEEN</div>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let timeLeft = 40 * 60;
        let timer = null;
        let isRunning = false;
        let tasks = JSON.parse(localStorage.getItem('wateen_final_v1')) || [];

        const roasts = [
            "ÙˆØªÙŠÙ†ØŒ Ø¹Ù‚Ù„Ùƒ ÙŠÙ†ØµØ¨ Ø¹Ù„ÙŠØ¬ Ù‡Ø³Ù‡! ğŸ˜‚", "Ø§Ù„ÙˆØ²Ø§Ø±ÙŠ ÙŠØ¨Ø§ÙˆØ¹ ÙˆÙŠÙ‚ÙˆÙ„: Ø®ÙˆØ´ ØªÙ…Ø«ÙŠÙ„ÙŠØ© ğŸ¤£", "Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„ØºØ´ØŒ Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ±Ø§Ù‚Ø¨ ğŸŒš",
            "Ù…ÙŠÙˆÙˆÙˆØ§Ù†Øª! Ø±ÙƒØ²ÙŠ Ù„Ø§ Ù†ØºÙŠØ± Ø§Ù„Ù†ØºÙ…Ø© ğŸˆ", "Ø§Ù„Ø³Ø§Ø¹Ø© ÙˆØ§Ù‚ÙØ©ØŸ Ù„Ø§ Ø§Ù†ØªÙŠ Ø§Ù„ÙˆØ§Ù‚ÙØ© ğŸ˜‚", "ØªØ¯Ø±ÙŠÙ† ÙƒØªØ§Ø¨ Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡ Ø¯Ø§ ÙŠØ¨Ø¬ÙŠ Ø¹Ù„ÙŠØ¬ØŸ ğŸ˜­",
            "Ø®Ø·Ø© Ø§Ù„Ù†ØµØ¨ ÙØ§Ø´Ù„Ø©ØŒ Ø§Ø±Ø¬Ø¹ÙŠ Ø§Ù‚Ø±ÙŠ ğŸ˜", "Ù‡Ø³Ù‡ Ù„Ùˆ Ø·Ø§Ù„Ø¹Ø© ÙˆÙŠØ© ØµØ¯ÙŠÙ‚Ø§ØªØ¬ Ù…Ùˆ Ø£Ø­Ø³Ù†ØŸ ğŸ˜‚", "ÙŠØ§ Ù…Ø¨Ø±Ù…Ø¬Ø©ØŒ ØµÙ„Ø­ØªÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø³ Ù…ØµÙ„Ø­ØªÙŠ Ø¬Ø¯ÙˆÙ„Ø¬ ğŸ˜‚",
            "ÙˆØªÙŠÙ† Ø§Ù„Ø¨Ø·Ù„Ø© (ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ù†ØµØ¨ ÙÙ‚Ø·) ğŸ¤£", "Ø±ÙƒØ²ÙŠ Ù…Ø±ÙˆØ©ØŒ Ø§Ù„Ø³Ø§Ø¯Ø³ Ù…ÙŠØ±Ø­Ù… ğŸ˜", "ØªØ±Ø§ Ø£Ø¹Ø±Ù Ø¬Ø§ÙŠ ØªÙÙƒØ±ÙŠÙ† Ø¨Ø§Ù„Ø¹Ø´Ø§Ø¡.. Ø±ÙƒØ²ÙŠ! ğŸ”"
        ];

        window.onload = () => { render(); updateUI(); };

        function playSound(freq, type = 'sine', duration = 0.1, vol = 0.1) {
            const osc = audioCtx.createOscillator(); const g = audioCtx.createGain();
            osc.type = type; osc.frequency.value = freq; osc.connect(g); g.connect(audioCtx.destination);
            g.gain.setValueAtTime(vol, audioCtx.currentTime);
            osc.start(); g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            osc.stop(audioCtx.currentTime + duration);
        }

        function showAlert(msg, iconClass = 'fa-ghost') {
            const box = document.getElementById('alertBox');
            document.getElementById('alertMsg').innerText = msg;
            document.getElementById('alertIcon').className = `fas ${iconClass}`;
            box.classList.add('active');
            setTimeout(() => box.classList.remove('active'), 3500);
        }

        function addTask() {
            const inp = document.getElementById('tInput');
            if(inp.value.trim()) {
                tasks.push({id: Date.now(), text: inp.value.trim(), done: false});
                inp.value = ''; save(); playSound(600);
            } else { showAlert("Ø¶ÙŠÙÙŠ Ø£Ù‡Ø¯Ø§Ù Ø£ÙˆÙ„Ø§Ù‹ ÙŠØ§ ÙˆØªÙŠÙ†! ğŸŒš", "fa-clipboard-list"); }
        }

        function save() { localStorage.setItem('wateen_final_v1', JSON.stringify(tasks)); render(); }

        function render() {
            document.getElementById('tList').innerHTML = tasks.map(t => `
                <div class="task-card">
                    <span style="font-family:'Tajawal'; font-weight:800; ${t.done ? 'text-decoration:line-through; opacity:0.3':''}">${t.text}</span>
                    <div class="check-btn ${t.done?'done':''}" onclick="checkTask(${t.id})"><i class="fas fa-check"></i></div>
                </div>`).join('');
        }

        function checkTask(id) {
            if(isRunning) {
                showAlert(roasts[Math.floor(Math.random()*roasts.length)], "fa-hand-paper");
                playSound(150, 'square', 0.2); return;
            }
            tasks = tasks.map(t => t.id === id ? {...t, done: !t.done} : t);
            save(); playSound(800);
        }

        function updateUI() {
            const m = Math.floor(timeLeft / 60); const s = timeLeft % 60;
            document.getElementById('tDisplay').innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
        }

        function handleTimer() {
            if(tasks.length === 0) { showAlert("Ø¶ÙŠÙÙŠ Ø£Ù‡Ø¯Ø§Ù Ø£ÙˆÙ„Ø§Ù‹! ğŸŒš", "fa-clipboard-list"); return; }
            const btn = document.getElementById('startBtn');
            if(isRunning) {
                isRunning = false; clearInterval(timer);
                btn.innerText = "Ø§Ø³ØªØ¦Ù†Ø§Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ©"; btn.className = "btn btn-main";
                playSound(150, 'triangle', 0.4); 
                showAlert("ØªÙ… Ø§Ù„ØªØ¬Ù…ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­.. Ù„Ø§ ØªØ·ÙˆÙ„ÙŠÙ†! ğŸ¥¶", "fa-snowflake");
            } else {
                isRunning = true;
                btn.innerText = "ØªØ¬Ù…ÙŠØ¯ Ø§Ù„Ù†ØµØ¨"; btn.className = "btn btn-main active-mode";
                playSound(500);
                timer = setInterval(() => { 
                    timeLeft--; updateUI(); 
                    if(timeLeft <= 0) { clearInterval(timer); isRunning = false; playSound(1000, 'sine', 0.5); }
                }, 1000);
            }
        }

        function openSheet() { playSound(150, 'sawtooth'); document.getElementById('sheetOverlay').style.display = 'flex'; }
        function closeSheet() { document.getElementById('sheetOverlay').style.display = 'none'; }
        
        function confirmReset() {
            localStorage.removeItem('wateen_final_v1');
            tasks = []; timeLeft = 40 * 60; isRunning = false; clearInterval(timer);
            document.getElementById('startBtn').innerText = "Ø¨Ø¯Ø¡ Ø§Ù„Ù†ØµØ¨";
            document.getElementById('startBtn').className = "btn btn-main";
            render(); updateUI(); closeSheet();
            showAlert("ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù….. Ø¨Ø§Ù„ØªÙˆÙÙŠÙ‚ Ù…Ø±ÙˆØ© ğŸ› ï¸", "fa-sync-alt");
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù€ Service Worker Ù„Ù„Ù€ PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js').catch(err => console.log('SW Error', err));
            });
        }
    </script>
</body>
</html>
