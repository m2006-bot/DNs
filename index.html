<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Wateen OS Elite</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">

    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg: #000000;
            --ios-gray: #1c1c1e;
            --accent: #00f3ff;
            --gold: #ffd700;
            --pink: #ff2d55;
        }

        /* Ø§Ù„Ø­Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯ ÙƒÙ…Ø§ Ø·Ù„Ø¨ØªÙ */
        html, body {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            overflow: hidden; background: #000;
            font-family: "Tajawal", sans-serif;
        }

        #app {
            position: fixed;
            inset: 0; /* Fullscreen Ø­Ù‚ÙŠÙ‚ÙŠ */
            display: flex;
            flex-direction: column;
            color: #fff;
        }

        /* Splash Screen (10s) */
        #splash {
            position: fixed; inset: 0; background: #000; z-index: 100000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 35px; text-align: center; transition: 1.2s ease-in-out;
        }
        .splash-logo { width: 90px; height: 90px; border-radius: 22px; border: 2px solid var(--accent); margin-bottom: 20px; }
        .m-name { color: var(--gold); font-weight: 900; }
        .loading-bar { width: 100%; height: 4px; background: #222; border-radius: 10px; margin-top: 25px; overflow: hidden; }
        .loading-fill { width: 0%; height: 100%; background: var(--accent); animation: load 10s linear forwards; }
        @keyframes load { to { width: 100%; } }

        /* Widgets */
        .top-nav { display: flex; justify-content: space-between; align-items: center; padding: 50px 25px 20px; }
        .widget { width: 32%; background: var(--ios-gray); padding: 12px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.05); }
        .widget-label { font-size: 0.6rem; color: #8e8e93; font-weight: 900; display: block; }
        .widget-val { font-size: 1.1rem; font-weight: 800; color: var(--accent); }

        /* Tasks Area */
        .main-container { flex: 1; display: flex; flex-direction: column; padding: 0 25px; overflow: hidden; }
        .input-wrapper { background: var(--ios-gray); padding: 15px; border-radius: 20px; display: flex; align-items: center; gap: 12px; margin-bottom: 15px; }
        .input-wrapper input { flex: 1; background: transparent; border: none; color: #fff; outline: none; }
        .task-scroll { flex: 1; overflow-y: auto; }
        .task-card { background: var(--ios-gray); padding: 18px; border-radius: 20px; display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
        .task-card.done { opacity: 0.3; text-decoration: line-through; }

        /* Timer UI */
        .timer-box { text-align: center; padding: 20px 0; }
        .time-val { font-size: 6rem; font-weight: 200; letter-spacing: -5px; font-variant-numeric: tabular-nums; }

        /* Footer & Buttons */
        .footer { margin-bottom: 30px; padding: 0 25px; }
        .action-row { display: grid; grid-template-columns: 1fr 70px; gap: 15px; }
        .btn { height: 65px; border-radius: 22px; border: none; font-weight: 900; font-size: 1.2rem; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .btn-play { background: #fff; color: #000; }
        .btn-play.active { background: var(--pink); color: #fff; }
        .btn-off { background: var(--ios-gray); color: #fff; }

        /* Toast */
        .toast { position: fixed; top: -100px; left: 20px; right: 20px; background: #1c1c1e; padding: 20px; border-radius: 20px; z-index: 1000000; transition: 0.6s; border: 1px solid rgba(255,255,255,0.1); }
        .toast.show { top: 40px; }
    </style>
</head>
<body>

    <div id="splash">
        <img src="https://iili.io/fkhg119.jpg" class="splash-logo">
        <h1 style="color:white; margin-bottom:10px;">WATEEN OS</h1>
        <p style="color:#8e8e93;">Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬Ø© <span class="m-name">Ù…Ø±ÙˆØ© Ù…Ø­Ù…Ø¯</span></p>
        <div class="loading-bar"><div class="loading-fill"></div></div>
    </div>

    <div id="app">
        <div class="toast" id="toast"><span id="toastMsg"></span></div>

        <div class="top-nav">
            <div class="widget"><span class="widget-label">REST</span><span class="widget-val" id="rc">0/12</span></div>
            <div style="text-align:center"><img src="https://iili.io/fkhg119.jpg" style="width:50px; border-radius:50%; border:2px solid var(--accent)"></div>
            <div class="widget" style="text-align:left"><span class="widget-label">STUDY</span><span class="widget-val" id="sc">0/12</span></div>
        </div>

        <div class="main-container">
            <div class="input-wrapper">
                <input type="text" id="taskInp" placeholder="Ù‡Ø¯ÙÙƒ Ø§Ù„Ù‚Ø§Ø¯Ù… ÙŠØ§ Ù…Ø±ÙˆØ©ØŸ">
                <i class="fas fa-plus-circle" style="color:var(--accent); font-size:1.6rem" onclick="addTask()"></i>
            </div>
            <div class="task-scroll" id="taskList"></div>
            <div class="timer-box"><div class="time-val" id="timeDisp">40:00</div></div>
        </div>

        <div class="footer">
            <div class="action-row">
                <button class="btn btn-play" id="mainBtn" onclick="toggleTimer()">Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ†ÙÙŠØ°</button>
                <button class="btn btn-off" onclick="appReset()"><i class="fas fa-redo"></i></button>
            </div>
        </div>
    </div>

    <script>
        // 1. ØªÙØ¹ÙŠÙ„ Fullscreen Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ§Ø¹Ù„ (Ø­Ù„ Ø§Ù„Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯)
        document.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(e => console.log(e));
            }
        }, { once: true });

        // 2. Ø·Ù„Ø¨ Ø¥Ø°Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„Ù„Ø¸Ù‡Ø§Ø± ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„Ù‡Ø§ØªÙ
        if ("Notification" in window) { Notification.requestPermission(); }

        const phrases = ["Ø±ÙƒØ²ÙŠ ÙŠØ§ Ø¨Ø·Ù„Ø© Ù…Ø±ÙˆØ©! ğŸ§ ", "Ø§Ù„ØµØ¯Ø±ÙŠØ© ØªÙ†ØªØ¸Ø±Ø¬.. Ù„Ø§ ØªØ³ØªØ³Ù„Ù…ÙŠÙ†! ğŸ¥¼", "Ø¹ÙˆÙÙˆØ§ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ØŒ ØªØ±Ø§ Ø§Ù„ÙˆØ²Ø§Ø±ÙŠ Ù…ÙŠØ±Ø­Ù…! ğŸŒš"];
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(freq, duration) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.frequency.value = freq;
            gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
            osc.start(); osc.stop(audioCtx.currentTime + duration);
        }

        let timeLeft = 40 * 60;
        let timer = null;
        let isRunning = false;
        let tasks = JSON.parse(localStorage.getItem('wateen_android_v1')) || [];

        setTimeout(() => { document.getElementById('splash').style.display='none'; }, 10000);

        function triggerToast(m) {
            document.getElementById('toastMsg').innerText = m;
            document.getElementById('toast').classList.add('show');
            setTimeout(() => document.getElementById('toast').classList.remove('show'), 3000);
            
            // Ø¥Ø¸Ù‡Ø§Ø± ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„Ù‡Ø§ØªÙ
            if (Notification.permission === "granted") {
                new Notification("Wateen OS", { body: m, icon: "https://iili.io/fkhg119.jpg", tag: "timer-info" });
            }
        }

        function addTask() {
            const inp = document.getElementById('taskInp');
            if(inp.value.trim()){
                tasks.push({id: Date.now(), text: inp.value.trim(), done: false});
                inp.value = ''; playSound(800, 0.1); sync();
            }
        }

        function sync() { localStorage.setItem('wateen_android_v1', JSON.stringify(tasks)); renderTasks(); }

        function renderTasks() {
            document.getElementById('taskList').innerHTML = tasks.map(t => `
                <div class="task-card ${t.done?'done':''}" onclick="checkTask(${t.id})">
                    <span>${t.text}</span>
                    <i class="fas ${t.done?'fa-check-circle':'fa-circle'}" style="color:var(--accent)"></i>
                </div>`).join('');
        }

        function checkTask(id) {
            tasks = tasks.map(t => t.id === id ? {...t, done: !t.done} : t);
            sync(); playSound(600, 0.1);
        }

        function toggleTimer() {
            playSound(1000, 0.05);
            const btn = document.getElementById('mainBtn');
            if(isRunning) {
                clearInterval(timer); isRunning = false;
                btn.innerText = "Ø§Ø³ØªØ¦Ù†Ø§Ù"; btn.classList.remove('active');
            } else {
                isRunning = true;
                btn.innerText = "ØªÙˆÙ‚Ù Ù…Ø¤Ù‚Øª"; btn.classList.add('active');
                triggerToast(phrases[Math.floor(Math.random()*phrases.length)]);
                timer = setInterval(() => {
                    timeLeft--;
                    const m = Math.floor(timeLeft/60); const s = timeLeft%60;
                    document.getElementById('timeDisp').innerText = `${m}:${s<10?'0':''}${s}`;
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„Ù‡Ø§ØªÙ ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
                    if(s === 0) triggerToast(`Ù…ØªØ¨Ù‚ÙŠ ${m} Ø¯Ù‚ÙŠÙ‚Ø© Ù…Ù† Ø§Ù„ØªØ±ÙƒÙŠØ²..`);

                    if(timeLeft <= 0) {
                        clearInterval(timer); isRunning = false;
                        playSound(1500, 0.5);
                        triggerToast("ÙƒÙÙˆÙˆÙˆ ÙŠØ§ Ù…Ø±ÙˆØ©! Ø¬ÙˆÙ„Ø© ÙƒØ§Ù…Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­ ğŸ¥³");
                    }
                }, 1000);
            }
        }

        function appReset() {
            if(confirm("ØªØµÙÙŠØ± Ø§Ù„Ø³Ø¬Ù„Ø§ØªØŸ")) {
                localStorage.clear(); location.reload();
            }
        }
        
        window.onload = renderTasks;
    </script>
</body>
</html>
