<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Watten OS Fluid | ï£¿</title>
    <style>
        :root {
            --gold: #D4AF37; --blue: #0A84FF; --orange: #FF9F0A;
            --red: #FF3B30; --green: #34C759; --card: rgba(28, 28, 30, 0.8);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, system-ui, sans-serif; }
        
        body { 
            background: #000; 
            height: 100dvh; 
            width: 100vw;
            display: flex; 
            justify-content: center; 
            align-items: center; 
            overflow: hidden; 
            color: #fff;
            padding: 10px; /* Ù…Ø³Ø§ÙØ© Ø£Ù…Ø§Ù† Ù„Ù„Ø­ÙˆØ§Ù */
        }

        /* Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…ØªÙ…Ø¯Ø¯ */
        .outer-frame {
            position: relative; 
            width: 100%; 
            height: 100%; 
            border-radius: 40px; 
            padding: 2px;
            background: var(--gold); 
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.15);
            transition: all 0.5s ease;
            display: flex; 
            justify-content: center; 
            align-items: center;
        }

        .frame-stop { background: var(--red) !important; box-shadow: 0 0 40px var(--red) !important; }
        .frame-run { background: var(--green) !important; box-shadow: 0 0 40px var(--green) !important; }

        .main-app {
            width: 100%; 
            height: 100%; 
            background: #000; 
            border-radius: 38px;
            display: flex; 
            flex-direction: column; 
            padding: 4% 5%; /* Ù‡ÙˆØ§Ù…Ø´ Ù†Ø³Ø¨ÙŠØ© */
            position: relative;
            overflow: hidden;
        }

        /* Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ¨ */
        .header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 20px;
            flex-shrink: 0;
        }
        
        .stat-card { 
            background: var(--card); 
            border: 1px solid #333; 
            border-radius: 15px; 
            padding: 10px 15px; 
            text-align: center;
            flex: 1;
            margin: 0 5px;
            max-width: 150px;
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ù…Ø±Ù†Ø© */
        .goals-area {
            flex: 1; 
            overflow-y: auto; 
            margin-bottom: 20px;
            padding-right: 5px;
            scrollbar-width: none;
        }
        .goals-area::-webkit-scrollbar { display: none; }

        .goal-item {
            background: var(--card); 
            border: 1px solid #222; 
            padding: 15px 20px;
            border-radius: 20px; 
            margin-bottom: 10px; 
            display: flex; 
            align-items: center; 
            gap: 15px;
            width: 100%;
            backdrop-filter: blur(10px);
        }
        
        .goal-text { font-size: clamp(1rem, 4vw, 1.4rem); font-weight: 600; flex: 1; color: #fff; }
        .check-box { width: 28px; height: 28px; border: 2px solid var(--green); border-radius: 50%; cursor: pointer; flex-shrink: 0; }
        .check-box.active { background: var(--green); box-shadow: 0 0 10px var(--green); }

        /* Ø§Ù„Ø³Ø§Ø¹Ø© - ØªØªÙ…Ø¯Ø¯ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø£ØµØºØ± Ø¨ÙØ¹Ø¯ Ù„Ù„Ø´Ø§Ø´Ø© */
        .clock-area { 
            text-align: center; 
            padding: 10px 0;
            flex-shrink: 0;
        }
        .time-val { 
            font-size: clamp(4rem, 20vh, 12rem); 
            font-weight: 800; 
            letter-spacing: -5px; 
            line-height: 0.9;
        }
        .mode-label { 
            letter-spacing: 6px; 
            color: var(--blue); 
            font-weight: bold; 
            font-size: clamp(0.7rem, 2vw, 1rem); 
            margin-top: 10px;
            text-transform: uppercase;
        }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø³ÙÙ„Ù‰ */
        .controls { 
            display: flex; 
            gap: 12px; 
            padding-top: 10px;
            flex-shrink: 0;
        }
        .ios-btn { 
            flex: 1; 
            height: clamp(50px, 8vh, 70px); 
            border-radius: 20px; 
            border: none; 
            font-size: 1.1rem; 
            font-weight: 700; 
            cursor: pointer; 
            transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        .btn-p { background: #fff; color: #000; }
        .btn-s { background: var(--card); color: #fff; border: 1px solid #333; }

        /* Dynamic Island */
        #island {
            position: absolute; top: -60px; left: 50%; transform: translateX(-50%);
            width: clamp(180px, 40%, 300px); 
            height: 45px; background: #fff; color: #000; border-radius: 22px;
            display: flex; align-items: center; justify-content: center; font-weight: 800; z-index: 3000; transition: 0.5s;
        }

        /* Modals */
        .modal { position: absolute; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(20px); z-index: 2000; display: none; justify-content: center; align-items: center; padding: 20px; }
        .modal-card { width: 100%; max-width: 400px; background: #111; padding: 30px; border-radius: 30px; border: 1px solid #333; }

        /* Ø§Ù„ØªØ¬Ø§ÙˆØ¨ Ù…Ø¹ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø¹Ø±Ø¶ÙŠ (Landscape) */
        @media (orientation: landscape) and (max-height: 500px) {
            .main-app { flex-direction: row; flex-wrap: wrap; }
            .header { width: 100%; height: auto; margin-bottom: 10px; }
            .goals-area { width: 50%; height: 100%; }
            .clock-area { width: 50%; display: flex; flex-direction: column; justify-content: center; }
            .time-val { font-size: 15vh; }
            .controls { width: 100%; }
        }
    </style>
</head>
<body>

    <div class="outer-frame" id="frame">
        <div id="island">WATTEN PRO ï£¿</div>

        <div id="settingsModal" class="modal">
            <div class="modal-card">
                <h3 style="color:var(--gold); margin-bottom:20px; text-align: center;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
                
                <p style="font-size: 0.8rem; color: #888; margin-bottom: 10px;">ÙˆÙ‚Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø© (Ø¯Ù‚ÙŠÙ‚Ø©):</p>
                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <button class="ios-btn btn-s" onclick="setT('s', 25)">25</button>
                    <button class="ios-btn btn-s" onclick="setT('s', 40)">40</button>
                    <button class="ios-btn btn-s" onclick="setT('s', 60)">60</button>
                </div>

                <p style="font-size: 0.8rem; color: #888; margin-bottom: 10px;">ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ±Ø§Ø­Ø© (Ø¯Ù‚ÙŠÙ‚Ø©):</p>
                <div style="display: flex; gap: 10px; margin-bottom: 30px;">
                    <button class="ios-btn btn-s" onclick="setT('b', 5)">5</button>
                    <button class="ios-btn btn-s" onclick="setT('b', 10)">10</button>
                    <button class="ios-btn btn-s" onclick="setT('b', 15)">15</button>
                </div>

                <button class="ios-btn" style="width:100%; background:var(--red); color:#fff" onclick="hardReset()">ØªØµÙÙŠØ± (Reset)</button>
                <button class="ios-btn btn-s" style="width:100%; margin-top:10px" onclick="closeM('settingsModal')">Ø±Ø¬ÙˆØ¹</button>
            </div>
        </div>

        <div id="goalModal" class="modal">
            <div class="modal-card">
                <h3 style="margin-bottom: 15px;">Ù‡Ø¯Ù Ø¯Ø±Ø§Ø³ÙŠ Ø¬Ø¯ÙŠØ¯ ğŸ¯</h3>
                <input type="text" id="goalInput" maxlength="100" style="width:100%; padding:20px; background:#000; border:1px solid #444; border-radius:15px; color:#fff; font-size:1.2rem; outline:none;" placeholder="Ø§ÙƒØªØ¨ÙŠ Ù‡Ø¯ÙÙƒÙ Ù…Ø±ÙˆØ©...">
                <button class="ios-btn btn-p" style="width:100%; margin-top:20px" onclick="addGoal()">ØªØ«Ø¨ÙŠØª</button>
                <button class="ios-btn btn-s" style="width:100%; margin-top:10px" onclick="closeM('goalModal')">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>

        <main class="main-app">
            <header class="header">
                <div class="stat-card" style="color:var(--orange)"><span>Ø±Ø§Ø­Ø©</span><b id="breakVal">0</b></div>
                <div style="font-weight:900; font-size:1.2rem; letter-spacing:3px;">WATTEN</div>
                <div class="stat-card" style="color:var(--blue)"><span>Ø¯Ø±Ø§Ø³Ø©</span><b id="studyVal">0</b></div>
            </header>

            <div class="goals-area">
                <button class="ios-btn btn-s" style="width:100%; border-style:dashed; margin-bottom:15px;" onclick="openM('goalModal')">+ Ø¥Ø¶Ø§ÙØ© Ù‡Ø¯Ù</button>
                <div id="goalsList"></div>
            </div>

            <div class="clock-area">
                <div class="time-val" id="timer">40:00</div>
                <div id="modeText" class="mode-label">Study Mode</div>
            </div>

            <div class="controls">
                <button class="ios-btn btn-s" onclick="openM('settingsModal')">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                <button class="ios-btn btn-p" id="startBtn" onclick="toggleTimer()">Ø¨Ø¯Ø¡</button>
            </div>
        </main>
    </div>

    <script>
        let sM = 40, bM = 10, timeLeft = 40 * 60, isRunning = false, mode = 'study', goals = 0, timer;
        const audio = new (window.AudioContext || window.webkitAudioContext)();

        function playIOS(type) {
            const o = audio.createOscillator(); const g = audio.createGain();
            o.connect(g); g.connect(audio.destination);
            if(type === 'start') { o.frequency.setValueAtTime(400, audio.currentTime); o.frequency.exponentialRampToValueAtTime(800, audio.currentTime + 0.1); }
            else if(type === 'stop') { o.frequency.setValueAtTime(300, audio.currentTime); }
            else if(type === 'add') { o.frequency.setValueAtTime(1000, audio.currentTime); }
            else if(type === 'done') { o.frequency.setValueAtTime(520, audio.currentTime); o.frequency.setValueAtTime(780, audio.currentTime + 0.1); }
            else if(type === 'reset') { o.type = 'sawtooth'; o.frequency.setValueAtTime(100, audio.currentTime); }
            o.start(); g.gain.exponentialRampToValueAtTime(0.0001, audio.currentTime + 0.5); o.stop(audio.currentTime + 0.5);
        }

        function showIsland(txt) {
            const is = document.getElementById('island'); is.innerText = txt;
            is.style.top = "20px"; setTimeout(() => is.style.top = "-60px", 2500);
        }

        function openM(id) { document.getElementById(id).style.display = 'flex'; }
        function closeM(id) { document.getElementById(id).style.display = 'none'; }

        function setT(type, val) {
            if(type === 's') sM = val; else bM = val;
            if(mode === (type==='s'?'study':'break')) timeLeft = val * 60;
            updateUI(); playIOS('add');
        }

        function addGoal() {
            const val = document.getElementById('goalInput').value;
            if(val) {
                goals++; playIOS('add');
                const div = document.createElement('div');
                div.className = 'goal-item';
                div.innerHTML = `<div class="check-box" onclick="markDone(this)"></div><span class="goal-text">${val}</span><span onclick="this.parentElement.remove(); goals--;" style="color:var(--red); font-weight:bold; cursor:pointer">âœ•</span>`;
                document.getElementById('goalsList').prepend(div);
                document.getElementById('goalInput').value = ''; closeM('goalModal');
                showIsland("ØªÙ… Ø§Ù„ØªØ«Ø¨ÙŠØª ï£¿");
            }
        }

        function markDone(el) {
            el.classList.toggle('active');
            el.parentElement.style.opacity = el.classList.contains('active') ? "0.3" : "1";
            if(el.classList.contains('active')) { playIOS('done'); showIsland("Ø£Ø­Ø³Ù†ØªÙ Ù…Ø±ÙˆØ©! âœ…"); }
        }

        function toggleTimer() {
            if(goals === 0) { playIOS('stop'); showIsland("Ø£Ø¶ÙŠÙÙŠ Ù‡Ø¯ÙØ§Ù‹ Ø£ÙˆÙ„Ø§Ù‹! âš ï¸"); return; }
            const frame = document.getElementById('frame');
            if(isRunning) {
                clearInterval(timer); playIOS('stop');
                frame.classList.add('frame-stop');
                setTimeout(() => frame.classList.remove('frame-stop'), 3000);
                document.getElementById('startBtn').innerText = "Ø§Ø³ØªØ¦Ù†Ø§Ù";
            } else {
                playIOS('start');
                timer = setInterval(tick, 1000);
                frame.classList.add('frame-run');
                document.getElementById('startBtn').innerText = "Ø¥ÙŠÙ‚Ø§Ù";
            }
            isRunning = !isRunning;
        }

        function tick() {
            if(timeLeft > 0) { timeLeft--; updateUI(); }
            else {
                clearInterval(timer); isRunning = false; playIOS('done');
                if(mode === 'study') {
                    document.getElementById('studyVal').innerText = parseInt(document.getElementById('studyVal').innerText) + 1;
                    mode = 'break'; timeLeft = bM * 60;
                } else {
                    document.getElementById('breakVal').innerText = parseInt(document.getElementById('breakVal').innerText) + 1;
                    mode = 'study'; timeLeft = sM * 60;
                }
                document.getElementById('frame').className = "outer-frame";
                document.getElementById('modeText').innerText = mode.toUpperCase() + " MODE";
                document.getElementById('startBtn').innerText = "Ø¨Ø¯Ø¡";
                updateUI();
            }
        }

        function updateUI() {
            let m = Math.floor(timeLeft/60), s = timeLeft%60;
            document.getElementById('timer').innerText = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
        }

        function hardReset() {
            playIOS('reset');
            showIsland("ØªØµÙÙŠØ± ÙƒØ§Ù…Ù„ Ø§Ù„Ù†Ø¸Ø§Ù…... ğŸ”„");
            setTimeout(() => {
                document.getElementById('goalsList').innerHTML = "";
                document.getElementById('studyVal').innerText = "0";
                document.getElementById('breakVal').innerText = "0";
                timeLeft = sM * 60;
                clearInterval(timer); isRunning = false;
                document.getElementById('frame').className = "outer-frame";
                document.getElementById('startBtn').innerText = "Ø¨Ø¯Ø¡";
                updateUI(); closeM('settingsModal');
            }, 600);
        }
    </script>
</body>
</html>
